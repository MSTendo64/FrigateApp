<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:FrigateApp.ViewModels"
             xmlns:vlc="using:LibVLCSharp.Avalonia"
             xmlns:media="using:Avalonia.Media"
             x:Class="FrigateApp.Views.LowLatencyCameraPlayerView"
             x:DataType="vm:LowLatencyCameraPlayerViewModel"
             x:CompileBindings="True">

    <Grid Background="#0d0d0d">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Верхняя панель -->
        <Border Grid.Row="0" Background="#1a1a1a" Padding="12,8" BorderBrush="#333" BorderThickness="0,0,0,1">
            <Grid ColumnDefinitions="Auto,*,Auto,Auto">
                <Button Content="← Назад" 
                        Command="{Binding BackCommand}" 
                        VerticalAlignment="Center"
                        Padding="12,6"
                        FontSize="13"/>
                
                <TextBlock Grid.Column="1" 
                           Text="{Binding DisplayName}" 
                           FontWeight="SemiBold" 
                           FontSize="16"
                           Foreground="White"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"/>
                
                <TextBlock Grid.Column="2"
                           Text="{Binding LatencyText}"
                           Foreground="#4CAF50"
                           FontSize="12"
                           VerticalAlignment="Center"
                           Margin="0,0,12,0"
                           FontWeight="SemiBold"/>
                
                <Button Grid.Column="3"
                        Content="↻"
                        Command="{Binding ReconnectCommand}"
                        Padding="8,6"
                        ToolTip.Tip="Переподключить"
                        FontSize="14"/>
            </Grid>
        </Border>

        <!-- VideoView для fMP4 -->
        <vlc:VideoView x:Name="VideoView"
                       Grid.Row="1"
                       IsVisible="{Binding !IsLoading}"/>

        <!-- Индикатор загрузки -->
        <StackPanel Grid.Row="1" 
                    HorizontalAlignment="Center" 
                    VerticalAlignment="Center"
                    IsVisible="{Binding IsLoading}" 
                    Spacing="12">
            <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
            <TextBlock Text="{Binding StatusText}" 
                       Foreground="White" 
                       HorizontalAlignment="Center"
                       FontSize="14"/>
        </StackPanel>

        <!-- Индикатор ошибки -->
        <StackPanel Grid.Row="1" 
                    HorizontalAlignment="Center" 
                    VerticalAlignment="Center"
                    IsVisible="{Binding HasError}" 
                    Spacing="12">
            <TextBlock Text="⚠️" FontSize="48" HorizontalAlignment="Center"/>
            <TextBlock Text="{Binding ErrorText}" 
                       Foreground="#ff6b6b" 
                       HorizontalAlignment="Center"
                       TextWrapping="Wrap" 
                       MaxWidth="400"
                       FontSize="14"
                       TextAlignment="Center"/>
            <Button Content="Переподключить" 
                    Command="{Binding ReconnectCommand}"
                    Padding="16,8"
                    Margin="0,8,0,0"/>
        </StackPanel>
    </Grid>
</UserControl>
